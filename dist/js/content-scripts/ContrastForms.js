"use strict";function ContrastForm(t){this.forms=t}function parentHasDisplayNone(t){for(;"BODY"!==t.tagName;){if("none"===t.style.display)return!0;t=t.parentNode}return!1}ContrastForm.MESSAGE_SENT=!1,ContrastForm._extractActionsFromForm=function(t){let r=[];for(let o=0;o<t.length;o++){let n=t[o];[n,!!n.action&&n.action.length>0].every(Boolean)&&r.push(n.action)}return r},ContrastForm.collectFormActions=function(t){chrome.storage.local.get(STORED_APPS_KEY,r=>{if(chrome.runtime.lastError)return;if(!r||!r[STORED_APPS_KEY])return;const o=new URL(window.location.href),n=getHostFromUrl(o);if(!r[STORED_APPS_KEY].filter(t=>t.host===n)[0])return;const e=this._scrapeDOMForForms()||[];this.MESSAGE_SENT=!0,this._sendFormActionsToBackground(e,t)})},ContrastForm._collectMutatedForms=function(t,r,o){const n=this._getFormsFromMutations(t);n.length>0&&(ContrastForm.MESSAGE_SENT=!0,this._sendFormActionsToBackground(n,o),window.CONTRAST__REFRESHED=!1,r.disconnect())}.bind(ContrastForm),ContrastForm._getFormsFromMutations=function(t){let r=[];return t.map(t=>{let o;if((o="FORM"===t.target.tagName?t.target:t.target.getElementsByTagName("form"))&&o.length>0){let t=this._extractActionsFromForm(o);return r.concat(t)}return null}).filter(Boolean)},ContrastForm._scrapeDOMForForms=function(){let t=[],r=[],o=document.getElementsByTagName("form");for(let r=0;r<o.length;r++)parentHasDisplayNone(o[r])||t.push(o[r]);return t.length>0&&(r=r.concat(this._extractActionsFromForm(t))),r},ContrastForm._sendFormActionsToBackground=function(t,r){r({sender:GATHER_FORMS_ACTION,formActions:deDupeArray(t.flatten())})},ContrastForm.highlightForms=function(t){if(!t||0===t.length)return!1;const r=document.getElementsByTagName("form");for(let o=0;o<r.length;o++){let n=r[o];if(t.includes(n.action)&&!parentHasDisplayNone(n)&&this._highlightSubmitInput(n))return!0}return!1},ContrastForm._highlightSubmitInput=function(t){let r,o=t.getElementsByTagName("input");for(let t=0,n=o.length;t<n;t++)r||"submit"!==o[t].type||(r=o[t]);return!!r&&(r.setAttribute("style",`border-radius: 5px;\n      border: 3px solid ${CONTRAST_GREEN}`),!0)};